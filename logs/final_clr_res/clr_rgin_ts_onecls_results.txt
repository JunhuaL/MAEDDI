Namespace(configfile='./configs/TWOSIDES/clr/4_clr_onecls_RGIN.yml')
{'dataset': 'TWOSIDES', 'task': 'binary', 'category': 'DDI', 'entry1_file': './dataset/TWOSIDES/drug/processed/data.pt', 'entry2_file': './dataset/TWOSIDES/drug/processed/data.pt', 'entry1_seq_file': './dataset/TWOSIDES/drug/drug.csv', 'pair_file': './dataset/TWOSIDES/binary_1vs1/entry_pairs.csv', 'label_file': './dataset/TWOSIDES/binary_1vs1/pair_labels.csv', 'save_folder': './output/CLR/RGIN/TWOSIDES/binary_1vs1/one_cluster/', 'split_strategy': 'whole_cluster_sampling', 'gconv_ckpt': './model_checkpoints/clr_epoch_RGIN_20_layers_4_random/last.ckpt', 'lin_eval': False, 'model_type': 'deepdrug', 'gpus': 0, 'num_out_dim': 1, 'n_layers': 4, 'g_conv': 'RGIN', 'lr': 0.0001}
print parameters:
{
  "earlystopping_tracking": "val_epoch_F1",
  "entry1_data_folder": "./dataset/TWOSIDES/drug",
  "entry1_seq_file": "./dataset/TWOSIDES/drug/drug.csv",
  "entry2_data_folder": "./dataset/TWOSIDES/drug",
  "entry2_seq_file": null,
  "entry_pairs_file": "./dataset/TWOSIDES/binary_1vs1/entry_pairs.csv",
  "gpus": 0,
  "model_type": "deepdrug",
  "pair_labels_file": "./dataset/TWOSIDES/binary_1vs1/pair_labels.csv",
  "save_folder": "./output/CLR/RGIN/TWOSIDES/binary_1vs1/one_cluster/",
  "scheduler_ReduceLROnPlateau_tracking": "F1",
  "split_strat": "whole_cluster_sampling",
  "task_type": "binary",
  "y_pred_file": "./output/CLR/RGIN/TWOSIDES/binary_1vs1/one_cluster/test_pred.csv",
  "y_transfrom_func": null,
  "y_true_file": "./output/CLR/RGIN/TWOSIDES/binary_1vs1/one_cluster/test_true.csv"
}
DeepDrug(
  (gconv1): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (gconv2): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (global_fc_nn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=32, bias=True)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Dropout(p=0.2, inplace=False)
    (7): ReLU()
  )
  (fc2): Linear(in_features=32, out_features=1, bias=True)
)
preparing dataset...
loading processed data...
add degrees as node features for each sample...
loading processed data...
add degrees as node features for each sample...
can not find cv_file,  whole_cluster_sampling ...
0.6603311553821332
0.1194859882596606
0.22018285635820622
in val dataloader...

val:Ep0000|| F1: 0.000,auROC nan,auPRC: 1.000
in train dataloader...

val:Ep0000|| F1: 0.601,auROC 0.711,auPRC: 0.631

trn:Ep0000|| F1: 0.714,auROC 0.720,auPRC: 0.750

val:Ep0001|| F1: 0.651,auROC 0.776,auPRC: 0.717

trn:Ep0001|| F1: 0.786,auROC 0.827,auPRC: 0.855

val:Ep0002|| F1: 0.658,auROC 0.766,auPRC: 0.692

trn:Ep0002|| F1: 0.822,auROC 0.875,auPRC: 0.901

val:Ep0003|| F1: 0.669,auROC 0.782,auPRC: 0.697

trn:Ep0003|| F1: 0.850,auROC 0.907,auPRC: 0.928

val:Ep0004|| F1: 0.700,auROC 0.814,auPRC: 0.732

trn:Ep0004|| F1: 0.870,auROC 0.925,auPRC: 0.944

val:Ep0005|| F1: 0.674,auROC 0.813,auPRC: 0.744

trn:Ep0005|| F1: 0.885,auROC 0.940,auPRC: 0.956

val:Ep0006|| F1: 0.676,auROC 0.781,auPRC: 0.697

trn:Ep0006|| F1: 0.894,auROC 0.948,auPRC: 0.962

val:Ep0007|| F1: 0.689,auROC 0.821,auPRC: 0.756

trn:Ep0007|| F1: 0.902,auROC 0.954,auPRC: 0.967

val:Ep0008|| F1: 0.672,auROC 0.832,auPRC: 0.754

trn:Ep0008|| F1: 0.907,auROC 0.958,auPRC: 0.970

val:Ep0009|| F1: 0.692,auROC 0.826,auPRC: 0.760

trn:Ep0009|| F1: 0.912,auROC 0.962,auPRC: 0.973

val:Ep0010|| F1: 0.672,auROC 0.834,auPRC: 0.782

trn:Ep0010|| F1: 0.916,auROC 0.965,auPRC: 0.975

val:Ep0011|| F1: 0.705,auROC 0.821,auPRC: 0.750

trn:Ep0011|| F1: 0.919,auROC 0.967,auPRC: 0.976

val:Ep0012|| F1: 0.707,auROC 0.823,auPRC: 0.756

trn:Ep0012|| F1: 0.921,auROC 0.968,auPRC: 0.977

val:Ep0013|| F1: 0.706,auROC 0.837,auPRC: 0.783

trn:Ep0013|| F1: 0.923,auROC 0.970,auPRC: 0.979

val:Ep0014|| F1: 0.714,auROC 0.835,auPRC: 0.763

trn:Ep0014|| F1: 0.925,auROC 0.971,auPRC: 0.979

val:Ep0015|| F1: 0.722,auROC 0.841,auPRC: 0.772

trn:Ep0015|| F1: 0.927,auROC 0.972,auPRC: 0.980

val:Ep0016|| F1: 0.709,auROC 0.840,auPRC: 0.783

trn:Ep0016|| F1: 0.929,auROC 0.973,auPRC: 0.981

val:Ep0017|| F1: 0.708,auROC 0.837,auPRC: 0.785

trn:Ep0017|| F1: 0.929,auROC 0.974,auPRC: 0.982

val:Ep0018|| F1: 0.706,auROC 0.836,auPRC: 0.788

trn:Ep0018|| F1: 0.930,auROC 0.974,auPRC: 0.982

val:Ep0019|| F1: 0.724,auROC 0.841,auPRC: 0.780

trn:Ep0019|| F1: 0.930,auROC 0.974,auPRC: 0.982

val:Ep0020|| F1: 0.712,auROC 0.838,auPRC: 0.788

trn:Ep0020|| F1: 0.932,auROC 0.975,auPRC: 0.983

val:Ep0021|| F1: 0.716,auROC 0.838,auPRC: 0.791

trn:Ep0021|| F1: 0.932,auROC 0.976,auPRC: 0.983

val:Ep0022|| F1: 0.719,auROC 0.854,auPRC: 0.806

trn:Ep0022|| F1: 0.933,auROC 0.976,auPRC: 0.984

val:Ep0023|| F1: 0.725,auROC 0.850,auPRC: 0.802

trn:Ep0023|| F1: 0.933,auROC 0.977,auPRC: 0.984

val:Ep0024|| F1: 0.724,auROC 0.849,auPRC: 0.803

trn:Ep0024|| F1: 0.935,auROC 0.977,auPRC: 0.984

val:Ep0025|| F1: 0.716,auROC 0.840,auPRC: 0.786

trn:Ep0025|| F1: 0.937,auROC 0.979,auPRC: 0.985

val:Ep0026|| F1: 0.727,auROC 0.853,auPRC: 0.809

trn:Ep0026|| F1: 0.936,auROC 0.978,auPRC: 0.985

val:Ep0027|| F1: 0.692,auROC 0.845,auPRC: 0.790

trn:Ep0027|| F1: 0.937,auROC 0.979,auPRC: 0.985

val:Ep0028|| F1: 0.725,auROC 0.854,auPRC: 0.816

trn:Ep0028|| F1: 0.938,auROC 0.979,auPRC: 0.986

val:Ep0029|| F1: 0.724,auROC 0.857,auPRC: 0.823

trn:Ep0029|| F1: 0.938,auROC 0.979,auPRC: 0.986

val:Ep0030|| F1: 0.729,auROC 0.856,auPRC: 0.814

trn:Ep0030|| F1: 0.940,auROC 0.980,auPRC: 0.986

val:Ep0031|| F1: 0.728,auROC 0.854,auPRC: 0.809

trn:Ep0031|| F1: 0.938,auROC 0.980,auPRC: 0.986

val:Ep0032|| F1: 0.686,auROC 0.837,auPRC: 0.794

trn:Ep0032|| F1: 0.940,auROC 0.980,auPRC: 0.987

val:Ep0033|| F1: 0.724,auROC 0.847,auPRC: 0.805

trn:Ep0033|| F1: 0.940,auROC 0.980,auPRC: 0.986

val:Ep0034|| F1: 0.718,auROC 0.841,auPRC: 0.790

trn:Ep0034|| F1: 0.939,auROC 0.981,auPRC: 0.987

val:Ep0035|| F1: 0.725,auROC 0.851,auPRC: 0.806

trn:Ep0035|| F1: 0.941,auROC 0.981,auPRC: 0.987

val:Ep0036|| F1: 0.718,auROC 0.856,auPRC: 0.819

trn:Ep0036|| F1: 0.941,auROC 0.981,auPRC: 0.987

val:Ep0037|| F1: 0.735,auROC 0.861,auPRC: 0.819

trn:Ep0037|| F1: 0.941,auROC 0.982,auPRC: 0.987

val:Ep0038|| F1: 0.731,auROC 0.857,auPRC: 0.821

trn:Ep0038|| F1: 0.942,auROC 0.982,auPRC: 0.988

val:Ep0039|| F1: 0.731,auROC 0.853,auPRC: 0.812

trn:Ep0039|| F1: 0.942,auROC 0.982,auPRC: 0.988

val:Ep0040|| F1: 0.730,auROC 0.859,auPRC: 0.824

trn:Ep0040|| F1: 0.943,auROC 0.982,auPRC: 0.988

val:Ep0041|| F1: 0.726,auROC 0.853,auPRC: 0.806

trn:Ep0041|| F1: 0.942,auROC 0.982,auPRC: 0.988

val:Ep0042|| F1: 0.727,auROC 0.855,auPRC: 0.816

trn:Ep0042|| F1: 0.944,auROC 0.983,auPRC: 0.988

val:Ep0043|| F1: 0.721,auROC 0.848,auPRC: 0.807

trn:Ep0043|| F1: 0.943,auROC 0.983,auPRC: 0.988

val:Ep0044|| F1: 0.737,auROC 0.861,auPRC: 0.823

trn:Ep0044|| F1: 0.944,auROC 0.983,auPRC: 0.989

val:Ep0045|| F1: 0.723,auROC 0.858,auPRC: 0.820

trn:Ep0045|| F1: 0.944,auROC 0.983,auPRC: 0.989

val:Ep0046|| F1: 0.740,auROC 0.866,auPRC: 0.832

trn:Ep0046|| F1: 0.944,auROC 0.984,auPRC: 0.989

val:Ep0047|| F1: 0.731,auROC 0.860,auPRC: 0.824

trn:Ep0047|| F1: 0.945,auROC 0.984,auPRC: 0.989

val:Ep0048|| F1: 0.732,auROC 0.857,auPRC: 0.807

trn:Ep0048|| F1: 0.946,auROC 0.984,auPRC: 0.989

val:Ep0049|| F1: 0.728,auROC 0.855,auPRC: 0.816
loading best weight in C:\Users\junhu\Desktop\Dissertation\MAEDDI\output\CLR\RGIN\TWOSIDES\binary_1vs1\one_cluster\models\epoch=46-step=10622.ckpt ...
DeepDrug(
  (gconv1): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (gconv2): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (global_fc_nn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=32, bias=True)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Dropout(p=0.2, inplace=False)
    (7): ReLU()
  )
  (fc2): Linear(in_features=32, out_features=1, bias=True)
)
in test dataloader...

tst:Ep0050|| F1: 0.768,auROC 0.830,auPRC: 0.830
------------------------------------------------------------------------------------------------------------------------
       Test metric             DataLoader 0
------------------------------------------------------------------------------------------------------------------------
        test_loss           0.7581145167350769
------------------------------------------------------------------------------------------------------------------------
in test dataloader...
save prediction completed.
