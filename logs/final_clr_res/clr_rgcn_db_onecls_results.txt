Namespace(configfile='./configs/DrugBank/clr/4_clr_onecls_RGCN.yml')
{'dataset': 'DrugBank', 'task': 'binary', 'category': 'DDI', 'entry1_file': './dataset/DrugBank/drug/processed/data.pt', 'entry2_file': './dataset/DrugBank/drug/processed/data.pt', 'entry1_seq_file': './dataset/DrugBank/drug/drug.csv', 'pair_file': './dataset/DrugBank/binary_1vs1/entry_pairs.csv', 'label_file': './dataset/DrugBank/binary_1vs1/pair_labels.csv', 'save_folder': './output/CLR/RGCN/DrugBank/binary_1vs1/one_cluster/', 'split_strategy': 'whole_cluster_sampling', 'gconv_ckpt': './model_checkpoints/clr_epoch_RGCN_20_layers_4_random/last.ckpt', 'lin_eval': False, 'model_type': 'deepdrug', 'gpus': 0, 'num_out_dim': 1, 'n_layers': 4, 'g_conv': 'RGCN', 'lr': 0.0001}
print parameters:
{
  "earlystopping_tracking": "val_epoch_F1",
  "entry1_data_folder": "./dataset/DrugBank/drug",
  "entry1_seq_file": "./dataset/DrugBank/drug/drug.csv",
  "entry2_data_folder": "./dataset/DrugBank/drug",
  "entry2_seq_file": null,
  "entry_pairs_file": "./dataset/DrugBank/binary_1vs1/entry_pairs.csv",
  "gpus": 0,
  "model_type": "deepdrug",
  "pair_labels_file": "./dataset/DrugBank/binary_1vs1/pair_labels.csv",
  "save_folder": "./output/CLR/RGCN/DrugBank/binary_1vs1/one_cluster/",
  "scheduler_ReduceLROnPlateau_tracking": "F1",
  "split_strat": "whole_cluster_sampling",
  "task_type": "binary",
  "y_pred_file": "./output/CLR/RGCN/DrugBank/binary_1vs1/one_cluster/test_pred.csv",
  "y_transfrom_func": null,
  "y_true_file": "./output/CLR/RGCN/DrugBank/binary_1vs1/one_cluster/test_true.csv"
}
DeepDrug(
  (gconv1): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (gconv2): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (global_fc_nn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=32, bias=True)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Dropout(p=0.2, inplace=False)
    (7): ReLU()
  )
  (fc2): Linear(in_features=32, out_features=1, bias=True)
)
preparing dataset...
loading processed data...
add degrees as node features for each sample...
loading processed data...
add degrees as node features for each sample...
can not find cv_file,  whole_cluster_sampling ...
0.6843709368124465
0.12457520477811235
0.1910538584094411
in val dataloader...

val:Ep0000|| F1: 0.000,auROC 0.468,auPRC: 0.106
in train dataloader...

val:Ep0000|| F1: 0.658,auROC 0.711,auPRC: 0.664

trn:Ep0000|| F1: 0.628,auROC 0.676,auPRC: 0.635

val:Ep0001|| F1: 0.639,auROC 0.731,auPRC: 0.688

trn:Ep0001|| F1: 0.687,auROC 0.748,auPRC: 0.717

val:Ep0002|| F1: 0.673,auROC 0.755,auPRC: 0.717

trn:Ep0002|| F1: 0.717,auROC 0.791,auPRC: 0.766

val:Ep0003|| F1: 0.636,auROC 0.772,auPRC: 0.739

trn:Ep0003|| F1: 0.744,auROC 0.824,auPRC: 0.804

val:Ep0004|| F1: 0.611,auROC 0.763,auPRC: 0.738

trn:Ep0004|| F1: 0.765,auROC 0.847,auPRC: 0.827

val:Ep0005|| F1: 0.688,auROC 0.790,auPRC: 0.760

trn:Ep0005|| F1: 0.782,auROC 0.864,auPRC: 0.845

val:Ep0006|| F1: 0.683,auROC 0.793,auPRC: 0.765

trn:Ep0006|| F1: 0.797,auROC 0.877,auPRC: 0.859

val:Ep0007|| F1: 0.678,auROC 0.807,auPRC: 0.779

trn:Ep0007|| F1: 0.807,auROC 0.887,auPRC: 0.870

val:Ep0008|| F1: 0.703,auROC 0.812,auPRC: 0.785

trn:Ep0008|| F1: 0.816,auROC 0.895,auPRC: 0.879

val:Ep0009|| F1: 0.675,auROC 0.800,auPRC: 0.782

trn:Ep0009|| F1: 0.825,auROC 0.903,auPRC: 0.887

val:Ep0010|| F1: 0.685,auROC 0.807,auPRC: 0.790

trn:Ep0010|| F1: 0.831,auROC 0.909,auPRC: 0.893

val:Ep0011|| F1: 0.685,auROC 0.809,auPRC: 0.792

trn:Ep0011|| F1: 0.837,auROC 0.914,auPRC: 0.899

val:Ep0012|| F1: 0.642,auROC 0.798,auPRC: 0.783

trn:Ep0012|| F1: 0.843,auROC 0.919,auPRC: 0.905

val:Ep0013|| F1: 0.708,auROC 0.815,auPRC: 0.800

trn:Ep0013|| F1: 0.848,auROC 0.923,auPRC: 0.910

val:Ep0014|| F1: 0.714,auROC 0.819,auPRC: 0.803

trn:Ep0014|| F1: 0.851,auROC 0.926,auPRC: 0.913

val:Ep0015|| F1: 0.696,auROC 0.805,auPRC: 0.790

trn:Ep0015|| F1: 0.856,auROC 0.930,auPRC: 0.918

val:Ep0016|| F1: 0.716,auROC 0.822,auPRC: 0.808

trn:Ep0016|| F1: 0.860,auROC 0.933,auPRC: 0.921

val:Ep0017|| F1: 0.724,auROC 0.826,auPRC: 0.813

trn:Ep0017|| F1: 0.864,auROC 0.937,auPRC: 0.926

val:Ep0018|| F1: 0.712,auROC 0.822,auPRC: 0.808

trn:Ep0018|| F1: 0.867,auROC 0.939,auPRC: 0.927

val:Ep0019|| F1: 0.684,auROC 0.815,auPRC: 0.802

trn:Ep0019|| F1: 0.869,auROC 0.941,auPRC: 0.931

val:Ep0020|| F1: 0.714,auROC 0.825,auPRC: 0.816

trn:Ep0020|| F1: 0.872,auROC 0.943,auPRC: 0.933

val:Ep0021|| F1: 0.709,auROC 0.829,auPRC: 0.816

trn:Ep0021|| F1: 0.875,auROC 0.945,auPRC: 0.935

val:Ep0022|| F1: 0.682,auROC 0.807,auPRC: 0.795

trn:Ep0022|| F1: 0.878,auROC 0.948,auPRC: 0.938

val:Ep0023|| F1: 0.679,auROC 0.811,auPRC: 0.801

trn:Ep0023|| F1: 0.881,auROC 0.949,auPRC: 0.940

val:Ep0024|| F1: 0.696,auROC 0.814,auPRC: 0.801

trn:Ep0024|| F1: 0.883,auROC 0.951,auPRC: 0.942

val:Ep0025|| F1: 0.641,auROC 0.809,auPRC: 0.796

trn:Ep0025|| F1: 0.885,auROC 0.953,auPRC: 0.944

val:Ep0026|| F1: 0.690,auROC 0.816,auPRC: 0.804
Epoch    28: reducing learning rate of group 0 to 1.0000e-05.

trn:Ep0026|| F1: 0.888,auROC 0.954,auPRC: 0.946

val:Ep0027|| F1: 0.702,auROC 0.823,auPRC: 0.811
loading best weight in C:\Users\junhu\Desktop\Dissertation\MAEDDI\output\CLR\RGCN\DrugBank\binary_1vs1\one_cluster\models\epoch=17-step=18396.ckpt ...
DeepDrug(
  (gconv1): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (gconv2): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (global_fc_nn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=32, bias=True)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Dropout(p=0.2, inplace=False)
    (7): ReLU()
  )
  (fc2): Linear(in_features=32, out_features=1, bias=True)
)
in test dataloader...

tst:Ep0028|| F1: 0.650,auROC 0.786,auPRC: 0.730
------------------------------------------------------------------------------------------------------------------------
       Test metric             DataLoader 0
------------------------------------------------------------------------------------------------------------------------
        test_loss           0.6611860990524292
------------------------------------------------------------------------------------------------------------------------
in test dataloader...
save prediction completed.
