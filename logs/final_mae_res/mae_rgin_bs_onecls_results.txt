Namespace(configfile='./configs/BIOSNAP/mae/4_mae_onecls_RGIN.yml')
{'dataset': 'BIOSNAP', 'task': 'binary', 'category': 'DDI', 'entry1_file': './dataset/BIOSNAP/drug/processed/data.pt', 'entry2_file': './dataset/BIOSNAP/drug/processed/data.pt', 'entry1_seq_file': './dataset/BIOSNAP/drug/drug.csv', 'pair_file': './dataset/BIOSNAP/binary_1vs1/entry_pairs.csv', 'label_file': './dataset/BIOSNAP/binary_1vs1/pair_labels.csv', 'save_folder': './output/MAE/RGIN/BIOSNAP/binary_1vs1/one_cluster/', 'split_strategy': 'whole_cluster_sampling', 'gconv_ckpt': './model_checkpoints/mae_epoch_RGIN_20_layers_4_random/last.ckpt', 'lin_eval': False, 'model_type': 'deepdrug', 'gpus': 0, 'num_out_dim': 1, 'n_layers': 4, 'g_conv': 'RGIN', 'lr': 0.0001}
print parameters:
{
  "earlystopping_tracking": "val_epoch_F1",
  "entry1_data_folder": "./dataset/BIOSNAP/drug",
  "entry1_seq_file": "./dataset/BIOSNAP/drug/drug.csv",
  "entry2_data_folder": "./dataset/BIOSNAP/drug",
  "entry2_seq_file": null,
  "entry_pairs_file": "./dataset/BIOSNAP/binary_1vs1/entry_pairs.csv",
  "gpus": 0,
  "model_type": "deepdrug",
  "pair_labels_file": "./dataset/BIOSNAP/binary_1vs1/pair_labels.csv",
  "save_folder": "./output/MAE/RGIN/BIOSNAP/binary_1vs1/one_cluster/",
  "scheduler_ReduceLROnPlateau_tracking": "F1",
  "split_strat": "whole_cluster_sampling",
  "task_type": "binary",
  "y_pred_file": "./output/MAE/RGIN/BIOSNAP/binary_1vs1/one_cluster/test_pred.csv",
  "y_transfrom_func": null,
  "y_true_file": "./output/MAE/RGIN/BIOSNAP/binary_1vs1/one_cluster/test_true.csv"
}
DeepDrug(
  (gconv1): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (gconv2): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (global_fc_nn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=32, bias=True)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Dropout(p=0.2, inplace=False)
    (7): ReLU()
  )
  (fc2): Linear(in_features=32, out_features=1, bias=True)
)
PreModel(
  (encoder): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (decoder): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=128, out_features=121, bias=True)
      (1): LayerNorm((121,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=128, out_features=11, bias=True)
      (1): LayerNorm((11,), eps=1e-05, elementwise_affine=True)
    )
    (edge_decoder): Linear(in_features=121, out_features=11, bias=True)
  )
  (encoder2decoder_nodes): Linear(in_features=128, out_features=128, bias=False)
  (encoder2decoder_edges): Linear(in_features=128, out_features=128, bias=False)
)
PreModel(
  (encoder): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (decoder): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=128, out_features=121, bias=True)
      (1): LayerNorm((121,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=128, out_features=11, bias=True)
      (1): LayerNorm((11,), eps=1e-05, elementwise_affine=True)
    )
    (edge_decoder): Linear(in_features=121, out_features=11, bias=True)
  )
  (encoder2decoder_nodes): Linear(in_features=128, out_features=128, bias=False)
  (encoder2decoder_edges): Linear(in_features=128, out_features=128, bias=False)
)
preparing dataset...
loading processed data...
add degrees as node features for each sample...
loading processed data...
add degrees as node features for each sample...
can not find cv_file,  whole_cluster_sampling ...
0.6989161849710983
0.11840077071290944
0.1826830443159923
in val dataloader...

val:Ep0000|| F1: 0.569,auROC 0.477,auPRC: 0.367
in train dataloader...

val:Ep0000|| F1: 0.847,auROC 0.849,auPRC: 0.892

trn:Ep0000|| F1: 0.685,auROC 0.766,auPRC: 0.721

val:Ep0001|| F1: 0.816,auROC 0.878,auPRC: 0.916

trn:Ep0001|| F1: 0.755,auROC 0.835,auPRC: 0.798

val:Ep0002|| F1: 0.870,auROC 0.889,auPRC: 0.923

trn:Ep0002|| F1: 0.787,auROC 0.868,auPRC: 0.834

val:Ep0003|| F1: 0.875,auROC 0.899,auPRC: 0.930

trn:Ep0003|| F1: 0.811,auROC 0.892,auPRC: 0.862

val:Ep0004|| F1: 0.850,auROC 0.891,auPRC: 0.920

trn:Ep0004|| F1: 0.830,auROC 0.909,auPRC: 0.883

val:Ep0005|| F1: 0.819,auROC 0.900,auPRC: 0.931

trn:Ep0005|| F1: 0.842,auROC 0.920,auPRC: 0.895

val:Ep0006|| F1: 0.810,auROC 0.901,auPRC: 0.926

trn:Ep0006|| F1: 0.860,auROC 0.933,auPRC: 0.911

val:Ep0007|| F1: 0.653,auROC 0.890,auPRC: 0.923

trn:Ep0007|| F1: 0.871,auROC 0.942,auPRC: 0.922

val:Ep0008|| F1: 0.662,auROC 0.924,auPRC: 0.949

trn:Ep0008|| F1: 0.879,auROC 0.948,auPRC: 0.932

val:Ep0009|| F1: 0.851,auROC 0.920,auPRC: 0.946

trn:Ep0009|| F1: 0.892,auROC 0.957,auPRC: 0.943

val:Ep0010|| F1: 0.878,auROC 0.931,auPRC: 0.953

trn:Ep0010|| F1: 0.899,auROC 0.961,auPRC: 0.948

val:Ep0011|| F1: 0.746,auROC 0.930,auPRC: 0.953

trn:Ep0011|| F1: 0.907,auROC 0.967,auPRC: 0.957

val:Ep0012|| F1: 0.759,auROC 0.933,auPRC: 0.957

trn:Ep0012|| F1: 0.912,auROC 0.970,auPRC: 0.961

val:Ep0013|| F1: 0.854,auROC 0.939,auPRC: 0.960

trn:Ep0013|| F1: 0.919,auROC 0.973,auPRC: 0.964

val:Ep0014|| F1: 0.778,auROC 0.937,auPRC: 0.959

trn:Ep0014|| F1: 0.924,auROC 0.976,auPRC: 0.968

val:Ep0015|| F1: 0.890,auROC 0.947,auPRC: 0.966

trn:Ep0015|| F1: 0.929,auROC 0.979,auPRC: 0.972

val:Ep0016|| F1: 0.873,auROC 0.942,auPRC: 0.963

trn:Ep0016|| F1: 0.935,auROC 0.981,auPRC: 0.976

val:Ep0017|| F1: 0.910,auROC 0.943,auPRC: 0.963

trn:Ep0017|| F1: 0.938,auROC 0.983,auPRC: 0.978

val:Ep0018|| F1: 0.838,auROC 0.942,auPRC: 0.962

trn:Ep0018|| F1: 0.940,auROC 0.985,auPRC: 0.980

val:Ep0019|| F1: 0.889,auROC 0.948,auPRC: 0.966

trn:Ep0019|| F1: 0.944,auROC 0.986,auPRC: 0.981

val:Ep0020|| F1: 0.888,auROC 0.953,auPRC: 0.969

trn:Ep0020|| F1: 0.947,auROC 0.987,auPRC: 0.983

val:Ep0021|| F1: 0.916,auROC 0.943,auPRC: 0.961

trn:Ep0021|| F1: 0.948,auROC 0.988,auPRC: 0.984

val:Ep0022|| F1: 0.712,auROC 0.935,auPRC: 0.958

trn:Ep0022|| F1: 0.951,auROC 0.989,auPRC: 0.985

val:Ep0023|| F1: 0.876,auROC 0.946,auPRC: 0.964

trn:Ep0023|| F1: 0.953,auROC 0.990,auPRC: 0.987

val:Ep0024|| F1: 0.775,auROC 0.943,auPRC: 0.964

trn:Ep0024|| F1: 0.955,auROC 0.990,auPRC: 0.987

val:Ep0025|| F1: 0.859,auROC 0.937,auPRC: 0.957

trn:Ep0025|| F1: 0.958,auROC 0.991,auPRC: 0.988

val:Ep0026|| F1: 0.818,auROC 0.941,auPRC: 0.960

trn:Ep0026|| F1: 0.960,auROC 0.992,auPRC: 0.989

val:Ep0027|| F1: 0.828,auROC 0.941,auPRC: 0.961

trn:Ep0027|| F1: 0.961,auROC 0.992,auPRC: 0.990

val:Ep0028|| F1: 0.786,auROC 0.948,auPRC: 0.965

trn:Ep0028|| F1: 0.962,auROC 0.993,auPRC: 0.990

val:Ep0029|| F1: 0.828,auROC 0.939,auPRC: 0.957

trn:Ep0029|| F1: 0.964,auROC 0.993,auPRC: 0.991

val:Ep0030|| F1: 0.828,auROC 0.950,auPRC: 0.967
Epoch    32: reducing learning rate of group 0 to 1.0000e-05.

trn:Ep0030|| F1: 0.964,auROC 0.993,auPRC: 0.991

val:Ep0031|| F1: 0.820,auROC 0.947,auPRC: 0.965
loading best weight in C:\Users\junhu\Desktop\Dissertation\MAEDDI\output\MAE\RGIN\BIOSNAP\binary_1vs1\one_cluster\models\epoch=21-step=4994.ckpt ...
DeepDrug(
  (gconv1): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (gconv2): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (global_fc_nn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=32, bias=True)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Dropout(p=0.2, inplace=False)
    (7): ReLU()
  )
  (fc2): Linear(in_features=32, out_features=1, bias=True)
)
in test dataloader...

tst:Ep0032|| F1: 0.761,auROC 0.832,auPRC: 0.846
------------------------------------------------------------------------------------------------------------------------
       Test metric             DataLoader 0
------------------------------------------------------------------------------------------------------------------------
        test_loss           0.7175546884536743
------------------------------------------------------------------------------------------------------------------------
in test dataloader...
save prediction completed.
