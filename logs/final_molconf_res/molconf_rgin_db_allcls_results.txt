Namespace(configfile='./configs/DrugBank/molconf/4_molconf_allcls_RGIN.yml')
{'dataset': 'DrugBank', 'task': 'binary', 'category': 'DDI', 'entry1_file': './dataset/DrugBank/drug/processed/data.pt', 'entry2_file': './dataset/DrugBank/drug/processed/data.pt', 'entry1_seq_file': './dataset/DrugBank/drug/drug.csv', 'pair_file': './dataset/DrugBank/binary_1vs1/entry_pairs.csv', 'label_file': './dataset/DrugBank/binary_1vs1/pair_labels.csv', 'save_folder': './output/mol_conf/RGIN/DrugBank/binary_1vs1/all_cluster/', 'split_strategy': 'sample_from_all_clusters', 'gconv_ckpt': './model_checkpoints/molconf_molconf_RGIN_epoch_20_layers_4_random/last.ckpt', 'lin_eval': False, 'model_type': 'deepdrug', 'gpus': 0, 'num_out_dim': 1, 'n_layers': 4, 'n_confs': 0, 'g_conv': 'RGIN', 'lr': 0.0001}
<class 'DeepGCN.RGINConv'>
print parameters:
{
  "earlystopping_tracking": "val_epoch_F1",
  "entry1_data_folder": "./dataset/DrugBank/drug",
  "entry1_seq_file": "./dataset/DrugBank/drug/drug.csv",
  "entry2_data_folder": "./dataset/DrugBank/drug",
  "entry2_seq_file": null,
  "entry_pairs_file": "./dataset/DrugBank/binary_1vs1/entry_pairs.csv",
  "gpus": 0,
  "model_type": "deepdrug",
  "pair_labels_file": "./dataset/DrugBank/binary_1vs1/pair_labels.csv",
  "save_folder": "./output/mol_conf/RGIN/DrugBank/binary_1vs1/all_cluster/",
  "scheduler_ReduceLROnPlateau_tracking": "F1",
  "split_strat": "sample_from_all_clusters",
  "task_type": "binary",
  "y_pred_file": "./output/mol_conf/RGIN/DrugBank/binary_1vs1/all_cluster/test_pred.csv",
  "y_transfrom_func": null,
  "y_true_file": "./output/mol_conf/RGIN/DrugBank/binary_1vs1/all_cluster/test_true.csv"
}
DeepDrug(
  (gconv1): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (gconv2): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (global_fc_nn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=32, bias=True)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Dropout(p=0.2, inplace=False)
    (7): ReLU()
  )
  (fc2): Linear(in_features=32, out_features=1, bias=True)
)
MolConfModel(
  (mol_encoder): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (conf_encoder): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=14, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=6, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (mol_lin): Linear(in_features=128, out_features=128, bias=True)
  (conf_lin): Linear(in_features=128, out_features=128, bias=True)
  (out_lin): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=128, out_features=64, bias=True)
  )
)
MolConfModel(
  (mol_encoder): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (conf_encoder): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=14, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=6, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (mol_lin): Linear(in_features=128, out_features=128, bias=True)
  (conf_lin): Linear(in_features=128, out_features=128, bias=True)
  (out_lin): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=128, out_features=64, bias=True)
  )
)
preparing dataset...
loading processed data...
add degrees as node features for each sample...
loading processed data...
add degrees as node features for each sample...
can not find cv_file,  sample_from_all_clusters ...
0.6342509869376287
0.13139024128630217
0.23435877177606915
in val dataloader...

val:Ep0000|| F1: 0.000,auROC nan,auPRC: 1.000
in train dataloader...

val:Ep0000|| F1: 0.720,auROC 0.709,auPRC: 0.695

trn:Ep0000|| F1: 0.635,auROC 0.667,auPRC: 0.629

val:Ep0001|| F1: 0.728,auROC 0.732,auPRC: 0.724

trn:Ep0001|| F1: 0.680,auROC 0.737,auPRC: 0.706

val:Ep0002|| F1: 0.602,auROC 0.734,auPRC: 0.748

trn:Ep0002|| F1: 0.709,auROC 0.775,auPRC: 0.748

val:Ep0003|| F1: 0.592,auROC 0.745,auPRC: 0.749

trn:Ep0003|| F1: 0.732,auROC 0.806,auPRC: 0.784

val:Ep0004|| F1: 0.687,auROC 0.769,auPRC: 0.783

trn:Ep0004|| F1: 0.752,auROC 0.831,auPRC: 0.811

val:Ep0005|| F1: 0.724,auROC 0.771,auPRC: 0.777

trn:Ep0005|| F1: 0.770,auROC 0.850,auPRC: 0.832

val:Ep0006|| F1: 0.687,auROC 0.780,auPRC: 0.788

trn:Ep0006|| F1: 0.782,auROC 0.862,auPRC: 0.845

val:Ep0007|| F1: 0.729,auROC 0.789,auPRC: 0.800

trn:Ep0007|| F1: 0.796,auROC 0.876,auPRC: 0.859

val:Ep0008|| F1: 0.726,auROC 0.790,auPRC: 0.808

trn:Ep0008|| F1: 0.804,auROC 0.884,auPRC: 0.868

val:Ep0009|| F1: 0.703,auROC 0.790,auPRC: 0.805

trn:Ep0009|| F1: 0.813,auROC 0.892,auPRC: 0.876

val:Ep0010|| F1: 0.744,auROC 0.805,auPRC: 0.816

trn:Ep0010|| F1: 0.822,auROC 0.901,auPRC: 0.886

val:Ep0011|| F1: 0.718,auROC 0.808,auPRC: 0.814

trn:Ep0011|| F1: 0.829,auROC 0.906,auPRC: 0.891

val:Ep0012|| F1: 0.718,auROC 0.810,auPRC: 0.820

trn:Ep0012|| F1: 0.836,auROC 0.912,auPRC: 0.897

val:Ep0013|| F1: 0.723,auROC 0.819,auPRC: 0.828

trn:Ep0013|| F1: 0.842,auROC 0.918,auPRC: 0.904

val:Ep0014|| F1: 0.710,auROC 0.805,auPRC: 0.817

trn:Ep0014|| F1: 0.848,auROC 0.922,auPRC: 0.909

val:Ep0015|| F1: 0.715,auROC 0.806,auPRC: 0.819

trn:Ep0015|| F1: 0.852,auROC 0.926,auPRC: 0.914

val:Ep0016|| F1: 0.704,auROC 0.808,auPRC: 0.821

trn:Ep0016|| F1: 0.857,auROC 0.930,auPRC: 0.917

val:Ep0017|| F1: 0.644,auROC 0.801,auPRC: 0.816

trn:Ep0017|| F1: 0.860,auROC 0.932,auPRC: 0.921

val:Ep0018|| F1: 0.697,auROC 0.813,auPRC: 0.827

trn:Ep0018|| F1: 0.865,auROC 0.936,auPRC: 0.924

val:Ep0019|| F1: 0.707,auROC 0.816,auPRC: 0.831
Epoch    21: reducing learning rate of group 0 to 1.0000e-05.

trn:Ep0019|| F1: 0.865,auROC 0.936,auPRC: 0.925

val:Ep0020|| F1: 0.704,auROC 0.819,auPRC: 0.834
loading best weight in C:\Users\junhu\Desktop\Dissertation\MAEDDI\output\mol_conf\RGIN\DrugBank\binary_1vs1\all_cluster\models\epoch=10-step=10428.ckpt ...
DeepDrug(
  (gconv1): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (gconv2): DeeperGCN(
    (node_encoder): Sequential(
      (0): Linear(in_features=121, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
    (gcn_blocks): ModuleList(
      (0): ModuleList(
        (0): DeepGCNLayerV2(block=res+)
        (1): DeepGCNLayerV2(block=res+)
        (2): DeepGCNLayerV2(block=res+)
        (3): DeepGCNLayerV2(block=res+)
      )
    )
    (edge_encoder): Sequential(
      (0): Linear(in_features=11, out_features=128, bias=True)
      (1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    )
  )
  (global_fc_nn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): Dropout(p=0.2, inplace=False)
    (3): ReLU()
    (4): Linear(in_features=128, out_features=32, bias=True)
    (5): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): Dropout(p=0.2, inplace=False)
    (7): ReLU()
  )
  (fc2): Linear(in_features=32, out_features=1, bias=True)
)
in test dataloader...

tst:Ep0021|| F1: 0.741,auROC 0.818,auPRC: 0.799
------------------------------------------------------------------------------------------------------------------------
       Test metric             DataLoader 0
------------------------------------------------------------------------------------------------------------------------
        test_loss           0.6034697890281677
------------------------------------------------------------------------------------------------------------------------
in test dataloader...
save prediction completed.
